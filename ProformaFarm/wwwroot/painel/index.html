<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Painel Backend | ProformaFarm ERP</title>
  <style>
    :root {
      --bg: #f4f7fb;
      --ink: #132238;
      --muted: #607086;
      --line: #d9e2ec;
      --card: #ffffff;
      --brand: #0d66c2;
      --brand-2: #0ba79d;
      --danger: #b03040;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: var(--bg);
      color: var(--ink);
    }
    .wrap { max-width: 1220px; margin: 0 auto; padding: 22px 16px 40px; }
    .head {
      background: linear-gradient(90deg, var(--brand), var(--brand-2));
      color: #fff;
      border-radius: 14px;
      padding: 18px;
      box-shadow: 0 16px 30px rgba(17, 38, 63, .18);
      margin-bottom: 16px;
    }
    h1 { margin: 0; font-size: 24px; }
    .sub { opacity: .95; margin-top: 6px; font-size: 14px; }
    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
      align-items: start;
    }
    .card {
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 14px;
    }
    .card h2 { margin: 0 0 10px; font-size: 18px; }
    .rows { display: grid; gap: 8px; }
    label { font-size: 12px; color: var(--muted); }
    input, select, button {
      width: 100%;
      padding: 9px 10px;
      border-radius: 8px;
      border: 1px solid #c8d4e1;
      font-size: 14px;
      background: #fff;
    }
    .line2 {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }
    .line3 {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 8px;
    }
    button {
      color: #fff;
      background: var(--brand);
      border: 0;
      font-weight: 600;
      cursor: pointer;
    }
    button.secondary { background: #243448; }
    .status {
      margin-top: 12px;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid var(--line);
      background: #fbfdff;
      font-size: 13px;
      white-space: pre-wrap;
      word-break: break-word;
      max-height: 260px;
      overflow: auto;
      font-family: Consolas, "Courier New", monospace;
    }
    .ok { color: #0a7d43; }
    .err { color: var(--danger); }
    .wide { grid-column: 1 / -1; }
    .table-wrap {
      margin-top: 10px;
      border: 1px solid var(--line);
      border-radius: 8px;
      overflow: auto;
      max-height: 360px;
      background: #fff;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
    }
    th, td {
      border-bottom: 1px solid #eef3f8;
      padding: 8px;
      text-align: left;
      white-space: nowrap;
    }
    thead th {
      position: sticky;
      top: 0;
      background: #f6f9fc;
      z-index: 1;
    }
    .hint {
      color: var(--muted);
      font-size: 12px;
      margin-top: 6px;
    }
    @media (max-width: 980px) {
      .grid { grid-template-columns: 1fr; }
      .line3 { grid-template-columns: 1fr; }
      .line2 { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="head">
      <h1>Painel Backend - Organizacao e Estoque</h1>
      <div class="sub">Cliente administrativo modular para API, retaguarda e frontend operacional.</div>
    </div>

    <div class="grid">
      <section class="card">
        <h2>Autenticacao</h2>
        <div class="rows">
          <label>Base URL da API</label>
          <input id="baseUrl" value="https://localhost:7293" />
          <div class="line2">
            <div>
              <label>Login</label>
              <input id="login" placeholder="it_org_admin" />
            </div>
            <div>
              <label>Senha</label>
              <input id="senha" type="password" placeholder="********" />
            </div>
          </div>
          <button id="btnLogin">Entrar e Gerar Token</button>
          <button class="secondary" id="btnLimpar">Limpar Token</button>
          <div id="authStatus" class="status">Sem token.</div>
        </div>
      </section>

      <section class="card">
        <h2>Organizacao</h2>
        <div class="rows">
          <div class="line2">
            <div>
              <label>IdOrganizacao (opcional)</label>
              <input id="orgId" type="number" placeholder="se vazio usa OrgContext" />
            </div>
            <div>
              <label>Acao</label>
              <select id="orgAction">
                <option value="contexto">Contexto Atual</option>
                <option value="estrutura">Estrutura</option>
                <option value="arvore">Arvore</option>
              </select>
            </div>
          </div>
          <button id="btnOrgConsultar">Consultar Organizacao</button>
          <div id="orgStatus" class="status">Aguardando consulta de organizacao...</div>
        </div>
      </section>

      <section class="card">
        <h2>Estoque (Consulta)</h2>
        <div class="rows">
          <div class="line3">
            <div>
              <label>Recurso</label>
              <select id="readResource">
                <option value="saldos">Saldos</option>
                <option value="reservasAtivas">Reservas Ativas</option>
                <option value="movimentacoes">Movimentacoes</option>
              </select>
            </div>
            <div>
              <label>Pagina (movimentacoes)</label>
              <input id="pagina" type="number" value="1" />
            </div>
            <div>
              <label>TamanhoPagina (movimentacoes)</label>
              <input id="tamanhoPagina" type="number" value="20" />
            </div>
          </div>
          <div class="line3">
            <div>
              <label>IdOrganizacao</label>
              <input id="idOrganizacao" type="number" placeholder="opcional" />
            </div>
            <div>
              <label>IdUnidade</label>
              <input id="idUnidade" type="number" placeholder="opcional" />
            </div>
            <div>
              <label>IdProduto</label>
              <input id="idProduto" type="number" placeholder="opcional" />
            </div>
          </div>
          <div class="line3">
            <div>
              <label>IdLote</label>
              <input id="idLote" type="number" placeholder="opcional" />
            </div>
            <div>
              <label>TipoMovimento</label>
              <input id="tipoMovimento" placeholder="ENTRADA/SAIDA/AJUSTE" />
            </div>
            <div>
              <label>Status Reserva</label>
              <input id="statusReserva" placeholder="ATIVA/EXPIRADA/..." />
            </div>
          </div>
          <button id="btnEstoqueConsultar">Consultar Estoque</button>
          <div id="readStatus" class="status">Aguardando consulta de estoque...</div>
          <div id="readTableWrap" class="table-wrap"></div>
          <div class="hint">Tabela preenchida para saldos, reservas ativas e movimentacoes.</div>
        </div>
      </section>

      <section class="card">
        <h2>Exportacao (CSV/PDF)</h2>
        <div class="rows">
          <div class="line3">
            <div>
              <label>Recurso</label>
              <select id="exportResource">
                <option value="saldos">Saldos</option>
                <option value="reservas">Reservas</option>
                <option value="movimentacoes">Movimentacoes</option>
              </select>
            </div>
            <div>
              <label>Formato</label>
              <select id="format">
                <option value="csv">CSV</option>
                <option value="pdf">PDF</option>
              </select>
            </div>
            <div>
              <label>Limite</label>
              <input id="limite" type="number" value="200" />
            </div>
          </div>
          <button id="btnExport">Exportar e Baixar Arquivo</button>
          <div id="exportStatus" class="status">Aguardando exportacao...</div>
        </div>
      </section>

      <section class="card wide">
        <h2>Operacoes Transacionais (Estoque/Reserva)</h2>
        <div class="rows">
          <div class="line3">
            <div>
              <label>Movimentacao</label>
              <select id="movAction">
                <option value="entrada">Entrada</option>
                <option value="saida">Saida</option>
                <option value="ajuste">Ajuste</option>
              </select>
            </div>
            <div>
              <label>Quantidade (entrada/saida)</label>
              <input id="movQuantidade" type="number" step="0.01" value="1" />
            </div>
            <div>
              <label>QuantidadeDisponivel (ajuste)</label>
              <input id="movQuantidadeDisponivel" type="number" step="0.01" value="0" />
            </div>
          </div>
          <div class="line2">
            <div>
              <label>DocumentoReferencia</label>
              <input id="movDocumento" placeholder="PAINEL-MOV" />
            </div>
            <div>
              <label>&nbsp;</label>
              <button id="btnMovExecutar">Executar Movimentacao</button>
            </div>
          </div>

          <div class="line3">
            <div>
              <label>Reserva Quantidade</label>
              <input id="resQuantidade" type="number" step="0.01" value="1" />
            </div>
            <div>
              <label>TTL (minutos)</label>
              <input id="resTtl" type="number" value="30" />
            </div>
            <div>
              <label>DocumentoReferencia</label>
              <input id="resDocumento" placeholder="PAINEL-RESERVA" />
            </div>
          </div>
          <button id="btnReservaCriar">Criar Reserva</button>

          <div class="line3">
            <div>
              <label>IdReservaEstoque</label>
              <input id="resId" type="number" placeholder="obrigatorio para confirmar/cancelar" />
            </div>
            <div>
              <label>Acao da Reserva</label>
              <select id="resAction">
                <option value="confirmar">Confirmar</option>
                <option value="cancelar">Cancelar</option>
              </select>
            </div>
            <div>
              <label>&nbsp;</label>
              <button id="btnReservaAcao">Executar Acao da Reserva</button>
            </div>
          </div>

          <div class="line2">
            <div>
              <label>Expirar Reservas - MaxItens</label>
              <input id="resExpirarMaxItens" type="number" value="200" />
            </div>
            <div>
              <label>&nbsp;</label>
              <button class="secondary" id="btnReservaExpirar">Processar Expiracao</button>
            </div>
          </div>

          <div id="txStatus" class="status">Aguardando operacoes transacionais...</div>
        </div>
      </section>
    </div>
  </div>

  <script type="module" src="/painel/js/main.js"></script>
</body>
</html>
